{
  "active": false,
  "connections": {
    "è®¾ç½®å‚æ•°-ç»¼åˆ": {
      "main": [
        [
          {
            "node": "æ£€æŸ¥è§†é¢‘ç±»å‹",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "éœ€æ±‚è¾“å…¥-è§†é¢‘": {
      "main": [
        [
          {
            "node": "è·¯ç”±-è‡ªåŠ¨åŒ–",
            "type": "main",
            "index": 2
          },
          {
            "node": "è·¯ç”±-è¡¨å•",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "æ£€æŸ¥è§†é¢‘ç±»å‹": {
      "main": [
        [
          {
            "node": "è§†é¢‘é¢„å¤„ç†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸Šä¼ è§†é¢‘": {
      "main": [
        [
          {
            "node": "ç­‰å¾…-æ–‡ä»¶å¤„ç†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ†æçˆ†æ¬¾è§†é¢‘": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-æå–æç¤ºè¯",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®å‚æ•°-æç¤ºè¯": {
      "main": [
        [
          {
            "node": "åˆ†æçˆ†æ¬¾è§†é¢‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®å‚æ•°-æå–æç¤ºè¯": {
      "main": [
        [
          {
            "node": "éå†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç­‰å¾…-æ–‡ä»¶å¤„ç†": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-æç¤ºè¯",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "éå†": {
      "main": [
        [
          {
            "node": "å¾ªç¯",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å¾ªç¯": {
      "main": [
        [
          {
            "node": "èšåˆ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Liblibæ‹¼æ¥-ç”Ÿå›¾",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "èšåˆ": {
      "main": [
        [
          {
            "node": "è§†é¢‘ç½‘å€æ‹¼æ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§†é¢‘ç”Ÿæˆ-Fal-Kling": {
      "main": [
        [
          {
            "node": "ç­‰å¾…-Fal",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·å–è§†é¢‘-Fal-Kling": {
      "main": [
        [
          {
            "node": "åˆ¤æ–­-Fal-Fluxlora1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç­‰å¾…-Fal": {
      "main": [
        [
          {
            "node": "è·å–è§†é¢‘-Fal-Kling",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ¤æ–­-Fal-Fluxlora1": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-è§†é¢‘ç½‘å€",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ç­‰å¾…-Fal",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®å‚æ•°-è§†é¢‘ç½‘å€": {
      "main": [
        [
          {
            "node": "å¾ªç¯",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "è§†é¢‘æç¤ºè¯-å›¾ç‰‡åŠ¨æ€è§†é¢‘",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "è§†é¢‘æç¤ºè¯-å›¾ç‰‡åŠ¨æ€è§†é¢‘": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-è§†é¢‘æç¤ºè¯",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸‹è½½å›¾ç‰‡": {
      "main": [
        [
          {
            "node": "è§†é¢‘æç¤ºè¯-å›¾ç‰‡åŠ¨æ€è§†é¢‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®å‚æ•°-è§†é¢‘æç¤ºè¯": {
      "main": [
        [
          {
            "node": "è§†é¢‘ç”Ÿæˆ-Fal-Kling",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸Šä¼ æ–‡ä»¶": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-æœ€ç»ˆè§†é¢‘ç½‘å€",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸‹è½½è§†é¢‘": {
      "main": [
        [
          {
            "node": "ä¸Šä¼ æ–‡ä»¶",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å£°éŸ³åˆæˆ-è£å‰ª": {
      "main": [
        [
          {
            "node": "æ°´å°åˆæˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§†é¢‘ç½‘å€æ‹¼æ¥": {
      "main": [
        [
          {
            "node": "è§†é¢‘æ‹¼æ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§†é¢‘æ‹¼æ¥": {
      "main": [
        [
          {
            "node": "å£°éŸ³åˆæˆ-è£å‰ª",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸‹è½½åˆ†æè§†é¢‘": {
      "main": [
        [
          {
            "node": "è·¯ç”±-è‡ªåŠ¨åŒ–",
            "type": "main",
            "index": 1
          },
          {
            "node": "è·¯ç”±-è¡¨å•",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "è§†é¢‘ä¸»é¢˜ç”Ÿæˆ": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-è§†é¢‘ä¸»é¢˜",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è‡ªåŠ¨åŒ–": {
      "main": [
        [
          {
            "node": "ä¸»é¢˜",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "è§†é¢‘ä¸»é¢˜ç”Ÿæˆ",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®å‚æ•°-è§†é¢‘ä¸»é¢˜": {
      "main": [
        [
          {
            "node": "è·¯ç”±-è‡ªåŠ¨åŒ–",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·³è½¬è§†é¢‘": {
      "main": [
        [
          {
            "node": "ä¿å­˜è§†é¢‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾ç½®å‚æ•°-æœ€ç»ˆè§†é¢‘ç½‘å€": {
      "main": [
        [
          {
            "node": "åˆ†æ”¯åˆ¤æ–­",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·¯ç”±-è¡¨å•": {
      "main": [
        [
          {
            "node": "ä¸Šä¼ è§†é¢‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è§†é¢‘é¢„å¤„ç†": {
      "main": [
        [
          {
            "node": "è·¯ç”±-è¡¨å•",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è·¯ç”±-è‡ªåŠ¨åŒ–": {
      "main": [
        [
          {
            "node": "è®¾ç½®å‚æ•°-ç»¼åˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Liblib ç”Ÿå›¾": {
      "main": [
        [
          {
            "node": "ç­‰å¾…",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç­‰å¾…": {
      "main": [
        [
          {
            "node": "Liblibæ‹¼æ¥-ç»“æœ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Liblibæ‹¼æ¥-ç”Ÿå›¾": {
      "main": [
        [
          {
            "node": "ç­¾å-ç”Ÿå›¾",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Liblibæ‹¼æ¥-ç»“æœ": {
      "main": [
        [
          {
            "node": "ç­¾å-ç»“æœ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç­¾å-ç»“æœ": {
      "main": [
        [
          {
            "node": "URL å®‰å…¨-ç»“æœ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç­¾å-ç”Ÿå›¾": {
      "main": [
        [
          {
            "node": "URL å®‰å…¨-ç”Ÿå›¾",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "URL å®‰å…¨-ç”Ÿå›¾": {
      "main": [
        [
          {
            "node": "Liblib ç”Ÿå›¾",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "URL å®‰å…¨-ç»“æœ": {
      "main": [
        [
          {
            "node": "Liblib ç»“æœ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Liblib ç»“æœ": {
      "main": [
        [
          {
            "node": "åˆ¤æ–­-Liblibæ•æ„Ÿ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ¤æ–­-Liblib": {
      "main": [
        [
          {
            "node": "ä¸‹è½½å›¾ç‰‡",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ç­‰å¾…",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ¤æ–­-Liblibæ•æ„Ÿ": {
      "main": [
        [
          {
            "node": "å¾ªç¯",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "åˆ¤æ–­-Liblib",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä¸»é¢˜": {
      "main": [
        [
          {
            "node": "è§†é¢‘ä¸»é¢˜ç”Ÿæˆ",
            "type": "main",
            "index": 0
          },
          {
            "node": "ä¸‹è½½åˆ†æè§†é¢‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "è§†é¢‘ä¸»é¢˜ç”Ÿæˆ",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "æ°´å°åˆæˆ": {
      "main": [
        [
          {
            "node": "ä¸‹è½½è§†é¢‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ†æ”¯åˆ¤æ–­": {
      "main": [
        [
          {
            "node": "è·³è½¬è§†é¢‘",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ä¿å­˜è§†é¢‘",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-08-09T04:30:49.190Z",
  "id": "HanNl2bP5zE6UScp",
  "isArchived": false,
  "meta": null,
  "name": "33.æ‰¹é‡ç”Ÿæˆä¸‡ç§é£æ ¼æŠ–éŸ³ TikTok çˆ†æ¬¾çŸ­è§†é¢‘ã€ç®€å•ç‰ˆæœ¬ã€‘",
  "nodes": [
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "fb38bd2d-146f-4040-996d-484f7b1e1ef6",
              "name": "è§†é¢‘ä¸»é¢˜",
              "value": "={{ $json['è§†é¢‘ä¸»é¢˜'] }}",
              "type": "string"
            },
            {
              "id": "0aa17899-3b88-404d-a680-57d8c1c4b4f4",
              "name": "åœºæ™¯æ•°é‡",
              "value": "={{ $json['åœºæ™¯æ•°é‡'] }}",
              "type": "string"
            },
            {
              "id": "d4d66345-a2c0-40af-b2dc-03b0fc99a722",
              "name": "æç¤ºè¯ç¤ºä¾‹",
              "value": "={{ $json['æç¤ºè¯ç¤ºä¾‹'] }}",
              "type": "string"
            },
            {
              "id": "67e8cf6d-cd55-4731-8012-8ab5f3f490c1",
              "name": "é…ä¹ç½‘å€",
              "value": "https://pub-b65afb21c951453a872a026d19411abe.r2.dev/shizishengyin.MP3",
              "type": "string"
            },
            {
              "id": "b34aabd3-afea-4b1f-9118-e8e26810c6d8",
              "name": "ä¸»æ¨¡å‹ç¼–å·",
              "value": "412b427ddb674b4dbab9e5abd5ae6057",
              "type": "string"
            },
            {
              "id": "77f73235-58da-411d-bc58-5e56b73b371b",
              "name": "Lora ç¼–å·",
              "value": "=afbf6e6f1cbe4bdf849032d9159dc6d4",
              "type": "string"
            },
            {
              "id": "c04dc62e-c80d-4eec-9914-37fbf8c48fe2",
              "name": "è§¦å‘è¯",
              "value": "=Film Photography",
              "type": "string"
            },
            {
              "id": "b6dffcd7-61d0-4053-a84d-712cf540d23a",
              "name": "å›¾ç‰‡ç‰¹æ®Šè¦æ±‚",
              "value": "=çœŸå®ï¼Œçºªå®é£æ ¼",
              "type": "string"
            },
            {
              "id": "7dee6cac-b186-4a91-ac2f-5d9fb7293334",
              "name": "è§†é¢‘ç‰¹æ®Šè¦æ±‚",
              "value": "=åŠ¨ç‰©ä¸–ç•Œçºªå½•ç‰‡çš„é•œå¤´è¯­è¨€",
              "type": "string"
            },
            {
              "id": "5900ecc9-f048-42b2-8da1-4b9594babe34",
              "name": "å•ä¸ªè§†é¢‘æ—¶é•¿",
              "value": "5",
              "type": "string"
            },
            {
              "id": "133e8060-5f67-4f4a-8ea4-21a2ed45abff",
              "name": "åˆ†æ”¯",
              "value": "={{ $json['åˆ†æ”¯'] }}",
              "type": "string"
            },
            {
              "id": "31f6f3a5-ae21-4910-b1ad-633d920131a4",
              "name": "Timestamp",
              "value": "={{ Date.now().toString() }}",
              "type": "string"
            },
            {
              "id": "0340a9a1-92ea-4d1d-87a0-5df84e9e051d",
              "name": "SignatureNonce",
              "value": "={{ Math.random().toString(36).slice(2) }}",
              "type": "string"
            },
            {
              "id": "7c292ab3-44fb-4259-ba50-2be64646b7fd",
              "name": "Liblib ç”Ÿå›¾",
              "value": "/api/generate/webui/text2img",
              "type": "string"
            },
            {
              "id": "ec4a96f3-afc6-4c6b-9da3-fc088b1c42ea",
              "name": "Liblib AccessKey",
              "value": "Vd4-AAoH2M6kSFwbw",
              "type": "string"
            },
            {
              "id": "0e214d75-0026-4755-9728-2d59218c8361",
              "name": "Liblib SecretKey",
              "value": "De7rJ_MyyDQugEatAjIm0JyJ",
              "type": "string"
            },
            {
              "id": "e38e4e09-5797-45b0-9064-1f85b9c7d7c1",
              "name": "Liblib ç»“æœ",
              "value": "/api/generate/webui/status",
              "type": "string"
            },
            {
              "id": "ea40dac7-caa8-4dea-b4b4-87c2ef226eb9",
              "name": "Liblib ç½‘å€",
              "value": "https://openapi.liblibai.cloud",
              "type": "string"
            },
            {
              "id": "619bf476-d1ab-4840-8cf5-263022a26eec",
              "name": "Google Cloud Storage Bucket name",
              "value": "n8n-bucket",
              "type": "string"
            },
            {
              "id": "0758eaa3-0caa-4bd8-bce9-2ab705896ae3",
              "name": "gemini",
              "value": "AIzaSyCvN0SrWsUU-mUSljv-NxEN2I",
              "type": "string"
            },
            {
              "id": "d40489d3-5687-4f2b-bf73-2d88182f39d0",
              "name": "NCA api key",
              "value": "123",
              "type": "string"
            },
            {
              "id": "ec1778a6-19cb-44ec-8111-18a9d55e86ec",
              "name": "NCA url",
              "value": "=https://no-code-architects-toolkit-00881.us-central1.run.app",
              "type": "string"
            },
            {
              "id": "e2f7b7b8-3ebb-4219-9ddb-6dee1dc6b6a9",
              "name": "fal ai api key",
              "value": "b4a6ef9e-fdc1-46bc-b62b-e9e:9c552862d267b671687508f182e24d16",
              "type": "string"
            },
            {
              "id": "def02153-ae31-46af-9238-b46d3e1d3a4b",
              "name": "Logo ç½‘å€",
              "value": "https://pub-b65afb21c951453a872a026d19411abe.r2.dev/xiangyu-logo.png",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -4400,
        368
      ],
      "id": "73420704-7ee9-4190-a4b9-9a6ab94fcc97",
      "name": "è®¾ç½®å‚æ•°-ç»¼åˆ"
    },
    {
      "parameters": {
        "formTitle": "ç¿”å®‡å·¥ä½œæµçˆ†æ¬¾è§†é¢‘ç”Ÿæˆå™¨",
        "formFields": {
          "values": [
            {
              "fieldLabel": "è§†é¢‘ä¸»é¢˜",
              "fieldType": "textarea"
            },
            {
              "fieldLabel": "æç¤ºè¯ç¤ºä¾‹",
              "fieldType": "textarea"
            },
            {
              "fieldLabel": "åœºæ™¯æ•°é‡"
            },
            {
              "fieldLabel": "åˆ†æ”¯",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "è‡ªåŠ¨åŒ–"
                  },
                  {
                    "option": "è¡¨å•"
                  }
                ]
              }
            },
            {
              "fieldLabel": "mp4",
              "fieldType": "file",
              "multipleFiles": false
            }
          ]
        },
        "options": {
          "appendAttribution": false,
          "buttonLabel": "åˆ›ä½œè§†é¢‘",
          "path": "xiangyu-video"
        }
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.2,
      "position": [
        -4832,
        768
      ],
      "id": "1eb93d40-3773-42e3-a513-420282e79c84",
      "name": "éœ€æ±‚è¾“å…¥-è§†é¢‘",
      "webhookId": "8d339343-017c-4d95-b598-cf960cd8351e"
    },
    {
      "parameters": {
        "jsCode": "/**\n * n8n Functionâ€ƒ|â€ƒBinary-only File-Meta Extractor\n * é€‚ç”¨ï¼šMP3 / MP4 / PDF / PNG / JPGï¼ˆå¯è‡ªè¡Œæ‰©å±•ï¼‰\n */\n\nconst item = $input.first();\n\n/* ----------------------------------------------------------\n * 0) å®šä½äºŒè¿›åˆ¶å— & æ ¡éªŒ\n * -------------------------------------------------------- */\nif (!item.binary || Object.keys(item.binary).length === 0) {\n\tthrow new Error('æœªæ£€æµ‹åˆ°äºŒè¿›åˆ¶æ•°æ®ï¼Œè¯·ç¡®è®¤ä¸Šä¸€æ­¥å·²æ­£ç¡®ä¸‹è½½æ–‡ä»¶');\n}\n\nconst binKey = Object.keys(item.binary).find(k => item.binary[k]?.data);\nif (!binKey) throw new Error('binary å¯¹è±¡ä¸­æœªæ‰¾åˆ°æœ‰æ•ˆçš„ .data å­—æ®µ');\n\nconst bin        = item.binary[binKey];\nconst base64Data = bin.data;\n\n/* ----------------------------------------------------------\n * 1) åŸºç¡€ä¿¡æ¯\n * -------------------------------------------------------- */\nconst fileName = bin.fileName || 'unknown';\nconst fileExtension =\n\t(bin.fileExtension || (fileName.includes('.') ? fileName.split('.').pop() : '')).toLowerCase();\n\nlet mimeType = bin.mimeType || '';\nif (!mimeType) {\n\tconst extMimeMap = {\n\t\tmp3 : 'audio/mpeg',\n\t\tmp4 : 'video/mp4',\n\t\tpdf : 'application/pdf',\n\t\tpng : 'image/png',\n\t\tjpg : 'image/jpeg',\n\t\tjpeg: 'image/jpeg',\n\t};\n\tmimeType = extMimeMap[fileExtension] || 'application/octet-stream';\n}\n\n/* ----------------------------------------------------------\n * 2) æ–‡ä»¶å¤§å°\n * -------------------------------------------------------- */\nconst fileSizeBytes = bin.fileSize || Buffer.from(base64Data, 'base64').length;\n\n// è‹¥åç»­èŠ‚ç‚¹æœ‰éœ€è¦ï¼Œå¯å†…éƒ¨ä½¿ç”¨è¯¥å‡½æ•°å¾—åˆ°å‹å¥½å°ºå¯¸\nconst formatBytes = (bytes, dp = 2) => {\n\tconst units = ['B', 'kB', 'MB', 'GB', 'TB'];\n\tlet i = 0;\n\twhile (bytes >= 1024 && i < units.length - 1) { bytes /= 1024; i++; }\n\treturn `${i === 0 ? bytes : bytes.toFixed(dp)} ${units[i]}`;\n};\nconst fileSizeFormatted = formatBytes(fileSizeBytes); // ä»…å†…éƒ¨ä½¿ç”¨ï¼Œä¸è¾“å‡º\n\n/* ----------------------------------------------------------\n * 3) ç±»å‹æ ¡éªŒ\n * -------------------------------------------------------- */\nconst typeCheck = {\n\tisAudio: mimeType.startsWith('audio/'),\n\tisVideo: mimeType.startsWith('video/'),\n\tisPdf  : mimeType === 'application/pdf',\n};\nconst isImage = mimeType.startsWith('image/'); // æ–°å¢ï¼šå›¾ç‰‡ç±»å‹\n\nif (!typeCheck.isAudio && !typeCheck.isVideo && !typeCheck.isPdf && !isImage) {\n\tthrow new Error(`ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹ï¼š${mimeType}ï¼ˆä»…ç¤ºä¾‹ MP3/MP4/PDF/PNG/JPGï¼‰`);\n}\n\n/* ----------------------------------------------------------\n * 4) è¿”å›ç»“æœï¼ˆå·²å»æ‰ fileSizeFormattedï¼‰\n * -------------------------------------------------------- */\nreturn {\n\tjson: {\n\t\tfileName,\n\t\tfileExtension,\n\t\tmimeType,\n\t\tfileSize: fileSizeBytes,\n\t\t...typeCheck,          // è¾“å‡ºå­—æ®µä¿æŒä¸å˜ï¼Œ**ä¸åŒ…å« isImage**\n\t\tuploadReady: true,\n\t\ttimestamp: new Date().toISOString(),\n\t},\n\tbinary: {\n\t\t...item.binary,\n\t\tfileName,\n\t\tmimeType,\n\t\tfileSize: fileSizeBytes,\n\t},\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4176,
        368
      ],
      "id": "b9e4c251-00e0-4131-bb61-916c3f40362e",
      "name": "æ£€æŸ¥è§†é¢‘ç±»å‹"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/upload/v1beta/files",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json.gemini }}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Length",
              "value": "={{ $json.mp4.size }}"
            },
            {
              "name": "X-Goog-Upload-Offset",
              "value": "0"
            },
            {
              "name": "X-Goog-Upload-Command",
              "value": "upload, finalize"
            }
          ]
        },
        "sendBody": true,
        "contentType": "binaryData",
        "inputDataFieldName": "mp4",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -3520,
        544
      ],
      "id": "3105e2b6-beb1-40a6-80db-c3826951cd1b",
      "name": "ä¸Šä¼ è§†é¢‘"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json.gemini }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": {{ JSON.stringify($('è®¾ç½®å‚æ•°-æç¤ºè¯').item.json.prompt) }}\n        },\n        {\n          \"file_data\": {\n            \"mime_type\": \"{{ $json.file.mimeType }}\",\n            \"file_uri\": \"{{ $json.file.uri }}\"\n          }\n        }\n      ]\n    }\n  ],\n\n  \"generationConfig\": {\n    \"responseMimeType\": \"application/json\",\n    \"responseSchema\": {\n      \"type\": \"OBJECT\",\n      \"properties\": {\n        \"storyboards\": {\n          \"type\": \"ARRAY\",\n          \"items\": {\n            \"type\": \"OBJECT\",\n            \"properties\": {\n              \"scene_id\":        { \"type\": \"INTEGER\" },\n              \"chinese_prompt\":  { \"type\": \"STRING\"  },\n              \"english_prompt\":  { \"type\": \"STRING\"  }\n            },\n            \"required\": [\n              \"scene_id\",\n              \"chinese_prompt\",\n              \"english_prompt\"\n            ],\n            \"propertyOrdering\": [\n              \"scene_id\",\n              \"chinese_prompt\",\n              \"english_prompt\"\n            ]\n          }\n        }\n      },\n      \"required\": [\n        \"storyboards\"\n      ],\n      \"propertyOrdering\": [\n        \"storyboards\"\n      ]\n    }\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2864,
        528
      ],
      "id": "f31b056c-2202-463d-bf1a-53cced7ae032",
      "name": "åˆ†æçˆ†æ¬¾è§†é¢‘"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "b875e50b-ac3f-4dff-bcde-8d67b9048360",
              "name": "prompt",
              "value": "=# è§’è‰²ï¼šçˆ†æ¬¾çŸ­è§†é¢‘å¤åˆ»ä¸åˆ›æ„å¤§å¸ˆ\n\nä½ æ˜¯ä¸€ä½ä¸“æ³¨äºTikTokã€Shortsç­‰çŸ­è§†é¢‘å¹³å°çš„çˆ†æ¬¾å†…å®¹å¤åˆ»ä¸åˆ›æ–°ä¸“å®¶ã€‚\nä½ çš„ä»»åŠ¡æ˜¯ï¼šç²¾å‡†åˆ†æç”¨æˆ·æä¾›çš„ã€å‚è€ƒçˆ†æ¬¾è§†é¢‘ã€‘ï¼Œæç‚¼å…¶æˆåŠŸçš„ã€ç—…æ¯’ä¼ æ’­å…³é”®æŠ€å·§ã€æ ¸å¿ƒæ–¹æ³•åŠè§†è§‰çˆ†ç‚¹ã€‘ï¼Œå¹¶å·§å¦™ç»“åˆç”¨æˆ·æä¾›çš„ã€å‚è€ƒå›¾ç‰‡æç¤ºè¯ã€‘ä¸­çš„é£æ ¼ä¸ç‰¹è‰²å…ƒç´ ï¼Œä»¥ç”¨æˆ·æŒ‡å®šçš„ã€æ–°è§†é¢‘ä¸»é¢˜ã€‘ä¸ºæ ¸å¿ƒï¼Œè®¾è®¡ä¸€ç³»åˆ—å…·å¤‡çˆ†æ¬¾æ½œè´¨çš„å›¾ç‰‡æç¤ºè¯ã€‚è¿™äº›æç¤ºè¯åº”æ˜ç¡®ä½“ç°å¯¹å‚è€ƒè§†é¢‘æˆåŠŸå…ƒç´ çš„ç²¾å‡†å¤åˆ»åŠå¯¹å›¾ç‰‡é£æ ¼çš„åˆ›æ„åº”ç”¨ï¼Œç¡®ä¿æ¯ä¸ªåˆ†é•œå…·å¤‡å¼ºçƒˆçš„ç—…æ¯’ä¼ æ’­æ½œåŠ›ã€‚\n\n## è¾“å…¥ä¿¡æ¯ï¼š\n1. **å‚è€ƒçˆ†æ¬¾è§†é¢‘ï¼š**\n   ç”¨æˆ·æä¾›ï¼Œç”¨äºæ·±å…¥åˆ†æå…¶è§†è§‰é£æ ¼ã€å™äº‹èŠ‚å¥ã€é•œå¤´è¯­è¨€å’Œçˆ†ç‚¹ã€‚\n\n2. **å‚è€ƒå›¾ç‰‡æç¤ºè¯ï¼š**\n   ç”¨æˆ·æä¾›çš„AIç»˜å›¾ç¤ºä¾‹æç¤ºè¯ï¼Œæå–é£æ ¼ã€æ„å›¾ã€å…³é”®è¯ç­‰å…ƒç´ ã€‚\n   {{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json['æç¤ºè¯ç¤ºä¾‹'] }}\n\n3. **æ–°è§†é¢‘ä¸»é¢˜ï¼š**\n   {{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json['è§†é¢‘ä¸»é¢˜'] }}\n\n4. **åˆ†é•œæ•°é‡ï¼š**\n   {{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json['åœºæ™¯æ•°é‡'] }}\n\n5. **è§¦å‘è¯ï¼š**\n   {{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json['è§¦å‘è¯'] }}\n   ï¼ˆè‹¥è§¦å‘è¯å­˜åœ¨ï¼Œæ¯ä¸ªåœºæ™¯æç¤ºè¯å¥é¦–æ”¾ç½®ï¼›è‹¥ä¸ºç©ºåˆ™æ— éœ€æ”¾ç½®ï¼‰\n6. **é¢å¤–è¦æ±‚ï¼š**\n   {{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json['å›¾ç‰‡ç‰¹æ®Šè¦æ±‚'] }}\n   ï¼ˆè‹¥é¢å¤–è¦æ±‚å­˜åœ¨ï¼Œåˆ™éœ€è¦éµå¾ªé¢å¤–è¦æ±‚çš„è§„åˆ™ï¼›è‹¥ä¸ºç©ºåˆ™æ— éœ€éµå®ˆï¼‰\n\n## æ ¸å¿ƒç›®æ ‡ï¼š\næ¯ä¸€æ¡ç”Ÿæˆçš„å›¾ç‰‡æç¤ºè¯éœ€ç²¾å‡†ä½“ç°æ–°ä¸»é¢˜ï¼Œå¹¶ä¸”å·§å¦™èå…¥å‚è€ƒè§†é¢‘ä¸­åˆ†æå¾—å‡ºçš„â€œç—…æ¯’ä¼ æ’­åŸºå› â€ï¼ŒåŒæ—¶åˆ›æ–°æ€§åœ°å€Ÿé‰´å‚è€ƒå›¾ç‰‡æç¤ºè¯ä¸­çš„ä¼˜ç§€å…ƒç´ ï¼Œä»¥è¾¾åˆ°ç”šè‡³è¶…è¶ŠåŸä½œçš„ä¼ æ’­æ•ˆæœã€‚\n\n## è¾“å‡ºè¦æ±‚ï¼š\n1.è¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹æ ¼å¼å°†ç»“æœå°è£…åœ¨å¯è¢«ç¨‹åºè§£æçš„JSONä¸­ã€‚\n* JSON å¯¹è±¡åŒ…å«ä¸€ä¸ªåä¸º storyboards çš„æ•°ç»„ï¼Œå¤–å±‚æ— éœ€ä½¿ç”¨ ```json ä»£ç å—åŒ…è£¹ã€‚\n* æ¯ä¸ªåˆ†é•œå…ƒç´ åŒ…å«ï¼š* åˆ†é•œID (`scene_id`)ã€ä¸­æ–‡å›¾ç‰‡æç¤ºè¯ (`chinese_prompt`)ã€è‹±æ–‡å›¾ç‰‡æç¤ºè¯ (`english_prompt`)ã€‚\næ¯ä¸ªæç¤ºè¯éœ€ç²¾å¿ƒè®¾è®¡ï¼Œæ˜ç¡®ä½“ç°çˆ†æ¬¾ç‰¹è´¨ï¼Œæ— éœ€åˆ›ä½œè¯´æ˜ï¼Œèåˆå›¾ç‰‡å‚è€ƒçš„ä¼˜ç§€å…ƒç´ ï¼Œæ¿€å‘è§‚çœ‹è€…å…´è¶£ã€‚\n2. æ¯æ¡æç¤ºè¯éœ€ç²¾å¿ƒé›•ç¢ï¼Œå‡†ç¡®æ•æ‰çˆ†æ¬¾è§†é¢‘çš„æ ¸å¿ƒè¦ç´ ï¼Œç¡®ä¿å…·å¤‡å¼ºçƒˆçš„è§†è§‰å†²å‡»åŠ›å’Œç—…æ¯’å¼ä¼ æ’­æ½œåŠ›ã€‚\n3. æç¤ºè¯åº”ç®€æ´ç›´æ¥ï¼Œæ— éœ€åŒ…å«ä»»ä½•åˆ›ä½œæŒ‡å¯¼æˆ–è¯´æ˜æ€§æ–‡å­—ã€‚\n4. è¯·æ§åˆ¶æ¯æ¡æç¤ºè¯çš„å­—æ•°åœ¨ 250-350 å­—èŒƒå›´å†…ï¼Œç¡®ä¿å®Œå…¨ç¬¦åˆ Flux å›¾åƒç”Ÿæˆæ¨¡å‹çš„è¾“å…¥è¦æ±‚å’Œæœ€ä½³å®è·µã€‚",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3072,
        544
      ],
      "id": "3c4a9061-9573-4f2d-8b7e-576dacfd69fd",
      "name": "è®¾ç½®å‚æ•°-æç¤ºè¯"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "b40e171c-a892-4f47-8429-ccd9b0f8f2f1",
              "name": "å›¾ç‰‡æç¤ºè¯",
              "value": "={{ $json.candidates[0].content.parts[0].text }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2640,
        544
      ],
      "id": "97ea29f4-146c-4722-8c48-429e7b3f64f7",
      "name": "è®¾ç½®å‚æ•°-æå–æç¤ºè¯"
    },
    {
      "parameters": {
        "amount": 1,
        "unit": "minutes"
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -3296,
        544
      ],
      "id": "0ac66eba-92b6-48a7-ba35-e05ce7536cd1",
      "name": "ç­‰å¾…-æ–‡ä»¶å¤„ç†",
      "webhookId": "8d7661e1-8daa-4e7d-8db5-bb3aca02ed1d"
    },
    {
      "parameters": {
        "fieldToSplitOut": "['å›¾ç‰‡æç¤ºè¯'].storyboards",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -2416,
        544
      ],
      "id": "541113e7-33c8-4a53-9592-30d34859548b",
      "name": "éå†"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -2192,
        544
      ],
      "id": "9a063f4f-b385-4377-bd27-00ead8f2245f",
      "name": "å¾ªç¯"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -1984,
        80
      ],
      "id": "7e365930-b1e8-4b76-a9c8-087d2aee02ee",
      "name": "èšåˆ"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://queue.fal.run/fal-ai/kling-video/v2.1/standard/image-to-video",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Key {{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json['fal ai api key'] }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n     \"prompt\": {{ JSON.stringify($('è®¾ç½®å‚æ•°-è§†é¢‘æç¤ºè¯').item.json['è§†é¢‘æç¤ºè¯']) }},\n     \"image_url\": \"{{ $('ä¸‹è½½å›¾ç‰‡').item.json.data.images[0].imageUrl }}\",\n     \"duration\": \"{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['å•ä¸ªè§†é¢‘æ—¶é•¿'] }}\",\n     \"aspect_ratio\": \"16:9\",\n     \"negative_prompt\": \"blur, distort, and low quality\",\n     \"cfg_scale\": 0.5\n}",
        "options": {
          "response": {}
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1264,
        416
      ],
      "id": "342a735e-cc8b-48c8-bc43-038fd7cdbf52",
      "name": "è§†é¢‘ç”Ÿæˆ-Fal-Kling"
    },
    {
      "parameters": {
        "url": "={{ $('è§†é¢‘ç”Ÿæˆ-Fal-Kling').item.json.response_url }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Key {{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json['fal ai api key'] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1728,
        336
      ],
      "id": "09d2ed0e-437c-4267-b0f3-38735c3513ad",
      "name": "è·å–è§†é¢‘-Fal-Kling",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "amount": 1,
        "unit": "minutes"
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1488,
        416
      ],
      "id": "a76f346e-6378-40de-b0b6-aa54e943c435",
      "name": "ç­‰å¾…-Fal",
      "webhookId": "cb50c144-3f29-4370-8a22-dd6a2c17fae5"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "43ed5f2c-d40d-4a8e-9d8a-2ae2a95ffaa3",
              "leftValue": "={{$json.video.url}}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1936,
        416
      ],
      "id": "995cede8-0a5c-4810-b8bc-14666fd14630",
      "name": "åˆ¤æ–­-Fal-Fluxlora1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "f13ed052-d4e4-4af8-a651-3d76fb737026",
              "name": "video",
              "value": "={{ $json.video.url }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2144,
        656
      ],
      "id": "5bd36704-a095-4399-8570-5213748ae34c",
      "name": "è®¾ç½®å‚æ•°-è§†é¢‘ç½‘å€"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-flash-preview-05-20",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        768,
        624
      ],
      "id": "b44b4669-a476-4b1d-8355-3079d7d10be7",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "3Mxs5FRI0mH2OJBL",
          "name": "Google Gemini(PaLM) Api account 2"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ç”»é¢å›¾ç‰‡å·²å‘é€\nç”Ÿæˆçš„å›¾ç‰‡çš„æç¤ºè¯å¦‚ä¸‹ï¼Œå¯ä¾›å‚è€ƒï¼š\n{{ $('å¾ªç¯').item.json.english_prompt }}\né¢å¤–è¦æ±‚ï¼š\n{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json['è§†é¢‘ç‰¹æ®Šè¦æ±‚'] }}\n",
        "options": {
          "systemMessage": "=# AI è§†é¢‘ç”Ÿæˆæç¤ºè¯æŒ‡å—ï¼ˆåŸºäºå›¾ç‰‡è¾“å…¥ï¼‰\n\n## ğŸ¬ è§’è‰²å®šä¹‰\n\nä½ æ˜¯ä¸€åé¡¶çº§è§†è§‰å™äº‹å¯¼æ¼”ä¸AIè§†é¢‘æç¤ºè¯ä¸“å®¶ã€‚ä½ çš„ä»»åŠ¡æ˜¯æ·±å…¥è§£è¯»ç”¨æˆ·æä¾›çš„é™æ€å›¾ç‰‡ï¼Œä»¥ç²¾å‡†æ„æ€å¹¶åˆ›ä½œé«˜åº¦ä¼˜åŒ–çš„è‹±æ–‡è§†é¢‘æç¤ºè¯ã€‚è¿™äº›æç¤ºè¯ä¸“ä¸ºæœ€æ–°çš„AIå›¾ç‰‡ç”Ÿæˆè§†é¢‘æ¨¡å‹è®¾è®¡ï¼ˆå¦‚ OpenAI Soraã€Runwayã€Pika Labsã€Luma AIã€Klingã€Google Veo ç­‰ï¼‰ï¼Œç”¨äºæŒ‡å¯¼ç”Ÿæˆ5-10ç§’åŠ¨æ€æµç•…çš„è§†é¢‘ã€‚\n\n## ğŸ¯ æ ¸å¿ƒç›®æ ‡\n\nè¾“å‡ºç²¾ç‚¼ä¸”é«˜è´¨é‡çš„è‹±æ–‡è§†é¢‘æç¤ºè¯ï¼Œä»¥ç²¾å‡†æ§åˆ¶åŠ¨æ€æ•ˆæœï¼Œç¡®ä¿è§†é¢‘æµç•…è‡ªç„¶ï¼Œä¸è¾“å…¥å›¾ç‰‡çš„è§†è§‰é£æ ¼å®Œç¾èåˆï¼Œé¿å…ä»»ä½•ä¸è‡ªç„¶çš„æ‰­æ›²æˆ–çªå…€æ„Ÿã€‚\n\n## ğŸ“¥ è¾“å…¥ä¿¡æ¯\n\n* è¾“å…¥å›¾ç‰‡ï¼ˆInput Imageï¼‰\n* ç”Ÿæˆå›¾ç‰‡çš„æç¤ºè¯\n  * ç¡®å®šè§†é¢‘ä¸»ä½“ã€æ„å›¾ã€è‰²å½©ã€å…‰å½±å’Œæ•´ä½“è‰ºæœ¯é£æ ¼ã€‚\n* é¢å¤–è¦æ±‚ï¼š\n  * è‹¥é¢å¤–è¦æ±‚å­˜åœ¨ï¼Œåˆ™éœ€è¦éµå¾ªé¢å¤–è¦æ±‚çš„è§„åˆ™ï¼›è‹¥ä¸ºç©ºåˆ™æ— éœ€éµå®ˆ\n\n## ğŸ› ï¸ æç¤ºè¯æ„å»ºåŸåˆ™\n\næ„å»ºæç¤ºè¯æ—¶ï¼Œé€æ­¥å¼•å…¥ä»¥ä¸‹å…ƒç´ ã€‚æ¯æ¬¡ä¿®æ”¹å»ºè®®ä»…è°ƒæ•´ä¸€ç§å…ƒç´ ï¼Œä»¥å‡†ç¡®è¯„ä¼°å…¶å½±å“ã€‚\n\næ¨èé¡ºåºï¼šä¸»ä½“è¿åŠ¨ â†’ åœºæ™¯è¿åŠ¨ â†’ é•œå¤´è¿åŠ¨ â†’ é£æ ¼æè¿°ã€‚\n\n### a. ä¸»ä½“è¿åŠ¨ (Subject Motion)\n\n* æ¸…æ™°æè¿°å›¾ç‰‡ä¸­ä¸»ä½“çš„åŠ¨ä½œã€å§¿æ€æˆ–è¡¨æƒ…å˜åŒ–ã€‚\n* æ˜ç¡®æŒ‡ç§°ä¸»ä½“ï¼šå¦‚ â€œthe subjectâ€, â€œthe figure in the foregroundâ€, â€œitâ€, â€œhe/sheâ€ã€‚\n* ç¤ºä¾‹ï¼š\n  * â€œThe subject slowly turns around.â€\n  * â€œThe figure in the foreground raises a hand.â€\n  * â€œThe cat blinks its eyes.â€\n\n### b. å¤šä¸»ä½“è¿åŠ¨ (Multiple Subjects)\n\n* ä½¿ç”¨ç©ºé—´ä½ç½®æˆ–æ˜¾è‘—ç‰¹å¾è¿›è¡ŒåŒºåˆ†ã€‚\n* ç¤ºä¾‹ï¼š\n  * â€œThe subject on the left walks forward, while the subject on the right remains still.â€\n  * â€œThe woman in the red dress nods; the man beside her waves.â€\n\n### c. åœºæ™¯è¿åŠ¨ (Scene Motion)\n\n* æè¿°ç¯å¢ƒå¯¹ä¸»ä½“åŠ¨ä½œçš„ååº”æˆ–è‡ªä¸»å˜åŒ–ã€‚\n* ç­–ç•¥ï¼š\n  * éšæ€§é©±åŠ¨ï¼ˆæ¨èï¼‰ï¼šæš—ç¤ºç¯å¢ƒå˜åŒ–ã€‚\n    * â€œThe subject runs through a dusty desert.â€\n  * æ˜¾æ€§æŒ‡ä»¤ï¼šæ˜ç¡®æè¿°ç¯å¢ƒå˜åŒ–ã€‚\n    * â€œThe subject runs through the desert, dust kicking up behind them.â€\n\n### d. é•œå¤´è¿åŠ¨ (Camera Motion)\n\n* æ˜ç¡®è™šæ‹Ÿæ‘„åƒæœºçš„è¿åŠ¨æ–¹å¼ä¸è½¨è¿¹ã€‚\n* å¯é€‰ç±»å‹ï¼šstatic shot, handheld camera, dolly zoom, pan, tracking shot, follow subject, focus pullã€‚\n* ç¤ºä¾‹ï¼š\n  * â€œHandheld camera follows the running dog.â€\n  * â€œSlow pan upwards to reveal the full height of the building.â€\n  * â€œCamera zooms in on the character's face.â€\n\n### e. é£æ ¼æè¿° (Style Descriptors)\n\n* è®¾å®šæ•´ä½“åŠ¨æ€èŠ‚å¥å’Œè§†è§‰ç¾å­¦ã€‚\n* ç»´åº¦åŒ…æ‹¬ï¼š\n  * è¿åŠ¨é€Ÿç‡ï¼šslow motion, fast-paced, time-lapse\n  * åŠ¨æ€è´¨æ„Ÿï¼šlive-action realism, smooth animation, stop-motion, hyperrealistic\n  * è‰ºæœ¯é£æ ¼ï¼šcinematic, dreamlike, retro film look, dramatic lighting, vibrant colors\n* ç¤ºä¾‹ï¼š\n  * â€œThe subject walks in the rain, cinematic, slow motion.â€\n  * â€œSunset over the city, time-lapse, vibrant colors, wide-angle shot.â€\n\n## âœ… æç¤ºè¯æœ€ä½³å®è·µ\n\n* ç²¾ç‚¼ç›´æ¥ï¼šä½¿ç”¨è‹±æ–‡ã€è¯­è¨€ç®€æ´æ˜äº†ï¼Œé¿å…æ­§ä¹‰ã€‚\n* èšç„¦åŠ¨æ€ï¼šæ˜ç¡®æè¿°åŠ¨ä½œä¸å˜åŒ–ï¼Œé¿å…é™æ€é‡å¤ã€‚\n* è‚¯å®šå¼æŒ‡ä»¤ï¼šç”¨ç§¯æã€æ˜ç¡®çš„æè¿°ï¼Œé¿å…è´Ÿé¢æŒ‡ä»¤ã€‚\n  * æ¨èï¼šâ€œremains stillâ€ è€Œé â€œdoes not moveâ€ã€‚\n* ç®€åŒ–å¥æ³•ï¼šé¿å…é•¿å¥å’Œå¤æ‚çš„ä»å¥ç»“æ„ã€‚\n* éå¯¹è¯æŒ‡ä»¤ï¼šç›´æ¥é™ˆè¿°æ‰€éœ€åŠ¨æ€ï¼Œé¿å…å£è¯­è¯·æ±‚ã€‚\n* è¿­ä»£ä¼˜åŒ–ï¼šä»ç®€å•åŠ¨ä½œå¼€å§‹ï¼Œé€æ­¥å¢åŠ å¤æ‚å…ƒç´ è¿›è¡ŒéªŒè¯ä¼˜åŒ–ã€‚\n\n## ğŸ“¤ è¾“å‡ºè¦æ±‚\n\nè¯·å°†ç²¾å¿ƒè®¾è®¡çš„è‹±æ–‡è§†é¢‘æç¤ºè¯ä¸¥æ ¼ç½®äº XML æ ‡ç­¾ä¸­è¾“å‡ºï¼Œæ— ä»»ä½•é¢å¤–å…ƒç´ ï¼š\n<prompt_en>Your precisely crafted English video prompt here.</prompt_en>\n\n* æç¤ºè¯ä¸¥æ ¼æ§åˆ¶åœ¨200è¯ä»¥å†…ã€‚\n* ç¡®ä¿ç‹¬ç«‹å®Œæ•´ã€å¯ç›´æ¥ç”¨äºé¡¶çº§AIè§†é¢‘ç”Ÿæˆæ¨¡å‹ã€‚\n* æè¿°ç²¾å‡†ã€å‡ç»ƒä¸”å¯Œæœ‰è§†è§‰è¡¨ç°åŠ›ã€‚\n\n",
          "passthroughBinaryImages": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        672,
        416
      ],
      "id": "11182d68-6693-4126-a681-6b6f7ec9c9b1",
      "name": "è§†é¢‘æç¤ºè¯-å›¾ç‰‡åŠ¨æ€è§†é¢‘",
      "retryOnFail": true
    },
    {
      "parameters": {
        "url": "={{ $json.data.images[0].imageUrl }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        448,
        416
      ],
      "id": "da3d6e5d-c49e-4263-9ef3-08bf6ed5ae72",
      "name": "ä¸‹è½½å›¾ç‰‡"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "756842f1-2847-41e8-a8a1-934efbd3de20",
              "name": "è§†é¢‘æç¤ºè¯",
              "value": "={{ $json.output.replace(/[\\s\\S]*<prompt_en>/, '').replace(/<\\/prompt_en>[\\s\\S]*/, '') }}",
              "type": "string"
            },
            {
              "id": "b0a67f14-7b0d-498e-a071-23da144fad73",
              "name": "å›¾ç‰‡æç¤ºè¯",
              "value": "={{ $('å¾ªç¯').item.json.english_prompt }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1056,
        416
      ],
      "id": "4f3d139c-2046-44b9-ac9a-c273711e4958",
      "name": "è®¾ç½®å‚æ•°-è§†é¢‘æç¤ºè¯"
    },
    {
      "parameters": {
        "resource": "object",
        "operation": "create",
        "bucketName": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').first().json['Google Cloud Storage Bucket name'] }}",
        "objectName": "={{$binary.data.fileName}}",
        "createData": {},
        "createQuery": {},
        "encryptionHeaders": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.googleCloudStorage",
      "typeVersion": 1,
      "position": [
        -656,
        80
      ],
      "id": "86e6c702-6439-4089-9cc7-2f4c58a9cc20",
      "name": "ä¸Šä¼ æ–‡ä»¶",
      "retryOnFail": true
    },
    {
      "parameters": {
        "url": "={{ $json.response[0].file_url }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -880,
        80
      ],
      "id": "43508ec8-49e1-4150-85f1-3780a981e09d",
      "name": "ä¸‹è½½è§†é¢‘"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['NCA url'] }}/v1/ffmpeg/compose",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "x-api-key",
              "value": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['NCA api key'] }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"id\": \"video-audio-fadeout\",\n  \"inputs\": [\n    {\n      \"file_url\": \"{{ $json.response }}\"\n    },\n    {\n      \"file_url\": \"{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['é…ä¹ç½‘å€'] }}\"\n    }\n  ],\n  \"filters\": [\n    {\n      \"filter\": \"[1:a]afade=t=out:st={{ Number($('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['åœºæ™¯æ•°é‡']) * Number($('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['å•ä¸ªè§†é¢‘æ—¶é•¿']) - 3 }}:d=3[aout]\"\n    }\n  ],\n  \"outputs\": [\n    {\n      \"options\": [\n        {\n          \"option\": \"-map\",\n          \"argument\": \"0:v:0\"\n        },\n        {\n          \"option\": \"-map\",\n          \"argument\": \"[aout]\"\n        },\n        {\n          \"option\": \"-c:v\",\n          \"argument\": \"libx264\"\n        },\n        {\n          \"option\": \"-c:a\",\n          \"argument\": \"aac\"\n        },\n        {\n          \"option\": \"-shortest\",\n          \"argument\": null\n        }\n      ]\n    }\n  ],\n  \"metadata\": {\n    \"duration\": true,\n    \"thumbnail\": true\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1312,
        80
      ],
      "id": "f2dd39cb-477b-4b1e-a506-3143d38ee99b",
      "name": "å£°éŸ³åˆæˆ-è£å‰ª"
    },
    {
      "parameters": {
        "jsCode": "/**\n * n8n Function â€ƒ |â€ƒ è§†é¢‘ URL åˆ—è¡¨èšåˆå™¨\n *\n * è¾“å…¥ç¤ºä¾‹ï¼ˆå•æ¡æˆ–å¤šæ¡ item å‡å¯ï¼‰ï¼š\n * {\n *   \"data\": [\n *     { \"video\": \"https://example.com/a.mp4\" },\n *     { \"video\": \"https://example.com/b.mp4\" }\n *   ]\n * }\n *\n * è¾“å‡ºç¤ºä¾‹ï¼š\n * {\n *   \"video_urls\": [\n *     { \"video_url\": \"https://example.com/a.mp4\" },\n *     { \"video_url\": \"https://example.com/b.mp4\" }\n *   ]\n * }\n */\n\nconst items = $input.all();    // 1) è¯»å–æ‰€æœ‰è¾“å…¥ item\nconst videoUrls = [];          // 2) ç”¨äºæ”¶é›†ç»“æœ\n\nitems.forEach(item => {\n\t// ---- è§£æ data æ•°ç»„ ----\n\tconst dataArr = item.json?.data;\n\tif (!Array.isArray(dataArr)) return;          // data ä¸æ˜¯æ•°ç»„ â†’ è·³è¿‡\n\n\tdataArr.forEach(obj => {\n\t\t// 3) ä¼˜å…ˆæŠ“å–å¸¸è§ç»“æ„ { video: \"https://...\" }\n\t\tif (obj?.video && typeof obj.video === 'string') {\n\t\t\tvideoUrls.push({ video_url: obj.video });\n\t\t\treturn;\n\t\t}\n\n\t\t// 4) å…¼å®¹å…¶ä»–å¸¸è§å­—æ®µï¼ˆå¯æŒ‰éœ€å¢åˆ ï¼‰\n\t\tconst fallback = obj?.url || obj?.video_url;\n\t\tif (fallback && typeof fallback === 'string') {\n\t\t\tvideoUrls.push({ video_url: fallback });\n\t\t}\n\t});\n});\n\n// ---- è¾“å‡º ----\n// å•æ¡ itemï¼ŒåŒ…å«å®Œæ•´æ•°ç»„\nreturn [\n\t{\n\t\tjson: {\n\t\t\tvideo_urls: videoUrls\n\t\t}\n\t}\n];\n\n/*\n * è‹¥æƒ³æ”¹æˆã€Œå¤šæ¡ itemï¼Œæ¯æ¡åªå«ä¸€ä¸ª video_urlã€ï¼Œæ”¹ç”¨ä¸‹é¢è¿™è¡Œï¼š\n * return videoUrls.map(v => ({ json: v }));\n */"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1760,
        80
      ],
      "id": "66dfe1a9-7606-4cb7-ab80-fa21ee8c3457",
      "name": "è§†é¢‘ç½‘å€æ‹¼æ¥"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['NCA url'] }}/v1/video/concatenate",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "x-api-key",
              "value": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['NCA api key'] }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ { \"video_urls\": $json.video_urls } }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1536,
        80
      ],
      "id": "a10e30ad-9752-4c70-8c1b-de2ec1a1c37c",
      "name": "è§†é¢‘æ‹¼æ¥"
    },
    {
      "parameters": {
        "url": "={{ $json['å‚è€ƒè§†é¢‘'] }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "mp4"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -4832,
        576
      ],
      "id": "85393fda-5c13-4d16-ada1-d69d918a1105",
      "name": "ä¸‹è½½åˆ†æè§†é¢‘"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=## çˆ†æ¬¾è§†é¢‘ç”»é¢æç¤ºè¯çš„ç¤ºä¾‹ï¼š\n{{ $json['æç¤ºè¯ç¤ºä¾‹'] }}\n\n## åœºæ™¯æ•°é‡ï¼š\n{{ $json['åœºæ™¯æ•°é‡'] }}\n\n## é€‰å®šä¸»é¢˜çš„åºå·:\n{{ Math.floor(Math.random() * 30) + 1 }} \n\n## å€™é€‰è§†é¢‘ä¸»é¢˜åˆ—è¡¨: \n{{ $json['ä¸»é¢˜æ±‡æ€»'] }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=# çˆ†æ¬¾è§†é¢‘ä¸»é¢˜é€‰æ‹©ä¸åœºæ™¯ç”Ÿæˆå™¨\n## ä»»åŠ¡ï¼š\n\nä½ çš„ä»»åŠ¡æ˜¯æ‰®æ¼”ä¸€ä¸ªç»éªŒä¸°å¯Œçš„çˆ†æ¬¾è§†é¢‘ç­–åˆ’å¸ˆã€‚å½“ç”¨æˆ·æä¾›â€œå¤šä¸ªå€™é€‰çš„è§†é¢‘ä¸»é¢˜â€åˆ—è¡¨ä»¥åŠä¸€ä¸ªâ€œæŒ‡å®šçš„åºå·â€æ—¶ï¼Œä½ éœ€è¦ï¼š\n\n1.  ä»ç”¨æˆ·æä¾›çš„â€œå€™é€‰è§†é¢‘ä¸»é¢˜åˆ—è¡¨â€ä¸­ï¼Œä¸¥æ ¼æŒ‰ç…§åˆ—è¡¨çš„é¡ºåºï¼Œå¹¶æ ¹æ®ç”¨æˆ·åœ¨è¾“å…¥ä¸­æŒ‡å®šçš„åºå· ï¼Œé€‰æ‹©ç›¸åº”çš„ä¸»é¢˜ä½œä¸ºæœ¬æ¬¡ç”Ÿæˆå†…å®¹çš„åŸºç¡€ã€‚\n2.  é’ˆå¯¹è¿™ä¸ªé€‰å®šçš„ä¸»é¢˜ï¼Œå‚è€ƒç”¨æˆ·æä¾›çš„çˆ†æ¬¾è§†é¢‘ç”»é¢æç¤ºè¯ç¤ºä¾‹ï¼Œæ„æ€å¹¶ç”ŸæˆåŒ…å«ä¸­è‹±æ–‡åœºæ™¯æè¿°çš„è§†é¢‘åœºæ™¯ã€‚\n3.  æœ€ç»ˆç»“æœå¿…é¡»ä»¥åŒ…å«ä¸»é¢˜ä¸­æ–‡ã€è‹±æ–‡ã€åœºæ™¯æ•°é‡åŠåœºæ™¯ä¸­è‹±æ–‡æè¿°çš„ JSON æ ¼å¼è¾“å‡ºã€‚\n\n## ç”¨æˆ·è¾“å…¥è¯´æ˜ï¼š\nä»ç”¨æˆ·é‚£é‡Œè·å–ä»¥ä¸‹ä¸‰ç±»ä¿¡æ¯ï¼š\n1.  çˆ†æ¬¾è§†é¢‘ç”»é¢æç¤ºè¯çš„ç¤ºä¾‹:\n    ç”¨æˆ·å¯ä»¥æä¾›ä¸€äº›ä»–ä»¬è®¤ä¸ºèƒ½å¤Ÿæ„æˆçˆ†æ¬¾è§†é¢‘çš„å…¸å‹ç”»é¢æˆ–åœºæ™¯çš„æè¿°æ€§æç¤ºè¯ã€‚è¿™äº›ç¤ºä¾‹å°†å¸®åŠ©AIç†è§£ç”¨æˆ·æœŸæœ›çš„ç”»é¢é£æ ¼å’Œå†…å®¹æ–¹å‘ã€‚\n2.  åœºæ™¯æ•°é‡ç¡®å®š\n3.  é€‰å®šä¸»é¢˜çš„åºå·: ä¸€ä¸ªæ•°å­—ï¼Œç”±ç”¨æˆ·æä¾›ï¼ŒæŒ‡æ˜ä»â€œå€™é€‰è§†é¢‘ä¸»é¢˜åˆ—è¡¨â€ä¸­é€‰æ‹©ç¬¬å‡ ä¸ªä¸»é¢˜ã€‚\n4.  å€™é€‰è§†é¢‘ä¸»é¢˜åˆ—è¡¨: å¤šä¸ªå€™é€‰è§†é¢‘ä¸»é¢˜çš„åˆ—è¡¨ã€‚\n\n## è¾“å‡ºè§„åˆ™ï¼š\n### 1. ä¸»é¢˜é€‰æ‹©\nä»ç”¨æˆ·æä¾›çš„â€œå€™é€‰è§†é¢‘ä¸»é¢˜åˆ—è¡¨â€ä¸­ï¼Œå¿…é¡»ä¸¥æ ¼æŒ‰ç…§åˆ—è¡¨çš„é¡ºåºï¼Œé€‰æ‹©ç”¨æˆ·åœ¨è¾“å…¥ä¿¡æ¯ä¸­æŒ‡å®šçš„åºå·ä½œä¸ºæœ¬æ¬¡ç”Ÿæˆå†…å®¹çš„åŸºç¡€ã€‚å¦‚æœåºå·ä¸å­˜åœ¨ï¼Œåˆ™éšæœºç”Ÿæˆä¸€ä¸ªåºå·é€‰æ‹©ä¸€ä¸ªã€‚\næ³¨æ„æ ¹æ®åºå·æå–åºå·ä¸‹æ‰€æœ‰å†…å®¹ï¼Œæ•´åˆä¸ºä¸€ä¸ªè§†é¢‘ä¸»é¢˜ã€‚\n\n### 2. åœºæ™¯æ„æ€ä¸æè¿°\nå¯¹äºé€‰å®šçš„ä¸»é¢˜å’Œç¡®å®šçš„åœºæ™¯æ•°é‡ï¼Œä½ éœ€è¦ä¸ºæ¯ä¸ªåœºæ™¯æ„æ€å…·ä½“å†…å®¹ï¼š\na. å‚è€ƒç”¨æˆ·ç¤ºä¾‹: åœ¨æ„æ€åœºæ™¯æ—¶ï¼Œåº”ç§¯æå‚è€ƒç”¨æˆ·æä¾›çš„â€œçˆ†æ¬¾è§†é¢‘ç”»é¢æç¤ºè¯çš„ç¤ºä¾‹â€ï¼Œç†è§£ç”¨æˆ·æœŸæœ›çš„è§†è§‰é£æ ¼ã€èŠ‚å¥æ„Ÿã€æƒ…æ„ŸåŸºè°ƒæˆ–å†…å®¹å€¾å‘ï¼Œå¹¶å°†è¿™äº›å…ƒç´ èå…¥åˆ°ä¸ºé€‰å®šä¸»é¢˜è®¾è®¡çš„åœºæ™¯ä¸­ã€‚\nb. ä¸»é¢˜ç›¸å…³æ€§: æ¯ä¸ªåœºæ™¯éƒ½å¿…é¡»ç´§å¯†å›´ç»•é€‰å®šçš„è§†é¢‘ä¸»é¢˜å±•å¼€ï¼Œå…±åŒæ„æˆä¸€ä¸ªæœ‰é€»è¾‘ã€æœ‰å¸å¼•åŠ›çš„å™äº‹æˆ–å±•ç¤ºåºåˆ—ã€‚ç¡®ä¿åœºæ™¯ä¹‹é—´æœ‰è‡ªç„¶çš„è¿‡æ¸¡å’Œè”ç³»ã€‚\nc. ä¸­è‹±æ–‡æè¿°: ä¸ºæ¯ä¸ªæ„æ€å‡ºçš„åœºæ™¯æä¾›ç®€æ´ã€ç”ŸåŠ¨ã€ä¸”å…·æœ‰ç”»é¢æ„Ÿçš„ä¸­æ–‡æè¿°å’Œå¯¹åº”çš„å‡†ç¡®è‹±æ–‡ç¿»è¯‘ã€‚æè¿°åº”èƒ½æ¸…æ™°ä¼ è¾¾åœºæ™¯çš„æ ¸å¿ƒå†…å®¹å’Œè§†è§‰æ•ˆæœã€‚\n\n### 3. ä¸»é¢˜ç¿»è¯‘\nä¸ºé€‰å®šçš„è§†é¢‘ä¸»é¢˜æä¾›å‡†ç¡®çš„ä¸­æ–‡åç§°ã€‚å¦‚æœç”¨æˆ·æä¾›çš„ä¸»é¢˜æœ¬èº«æ˜¯å¯¹è±¡ä¸”åŒ…å«æ˜ç¡®çš„æ ‡é¢˜ï¼Œåˆ™ç›´æ¥ä½¿ç”¨è¯¥æ ‡é¢˜ã€‚\nä¸ºé€‰å®šçš„è§†é¢‘ä¸»é¢˜æä¾›å¯¹åº”çš„ã€è‡ªç„¶çš„è‹±æ–‡ç¿»è¯‘ã€‚\n\n## è¾“å‡ºæ ¼å¼è¦æ±‚ï¼š\nè¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹ JSON ç»“æ„è¾“å‡ºç»“æœã€‚ç¡®ä¿æ‰€æœ‰å­—ç¬¦ä¸²å€¼éƒ½åŒ…å«åœ¨åŒå¼•å·å†…ï¼Œå¹¶ä¸”JSONç»“æ„å®Œæ•´æœ‰æ•ˆã€‚\n{\n    \"video_description_zh\": \"<é€‰å®šä¸»é¢˜çš„ä¸­æ–‡400 å­—æè¿°>\",\n    \"video_description_en\": \"<é€‰å®šä¸»é¢˜çš„è‹±æ–‡400 å­—æè¿°>\",\n    \"suitable_scene_count\": \"<æ˜ç¡®æ ‡æ³¨æˆ–åˆç†æ¨æ–­çš„åœºæ™¯æ•°é‡>\"\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        -5216,
        304
      ],
      "id": "92782e34-f254-4b76-bd4a-4b53345e5600",
      "name": "è§†é¢‘ä¸»é¢˜ç”Ÿæˆ",
      "retryOnFail": true
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 17
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -5664,
        448
      ],
      "id": "c5c3955c-f35c-4483-a6fc-a7a6be049ae8",
      "name": "è‡ªåŠ¨åŒ–"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n    \"video_description_zh\": \"<é€‰å®šä¸»é¢˜çš„ä¸­æ–‡æè¿°>\",\n    \"video_description_en\": \"<é€‰å®šä¸»é¢˜çš„è‹±æ–‡æè¿°>\",\n    \"suitable_scene_count\": \"<æ˜ç¡®æ ‡æ³¨æˆ–åˆç†æ¨æ–­çš„åœºæ™¯æ•°é‡>\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        -5056,
        528
      ],
      "id": "be77c49a-dfe0-4bf7-bab5-fd489d2d28ac",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "90660f43-f4f4-43e4-b0a5-d485d720aabe",
              "name": "è§†é¢‘ä¸»é¢˜",
              "value": "={{ $json.output.video_description_en }}",
              "type": "string"
            },
            {
              "id": "af98d1c8-91f9-48ea-9ce6-949ca16a602a",
              "name": "åœºæ™¯æ•°é‡",
              "value": "={{ $json.output.suitable_scene_count }}",
              "type": "string"
            },
            {
              "id": "5e039d12-52a6-4443-81b6-b176a6a5444b",
              "name": "åˆ†æ”¯",
              "value": "è‡ªåŠ¨åŒ–",
              "type": "string"
            },
            {
              "id": "9734b476-fbbb-419e-8fd9-4e3b6c414f3f",
              "name": "æç¤ºè¯ç¤ºä¾‹",
              "value": "={{ $('ä¸»é¢˜').item.json['æç¤ºè¯ç¤ºä¾‹'] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -4832,
        304
      ],
      "id": "ef623f99-64d2-4216-a4fb-c4cd52522f63",
      "name": "è®¾ç½®å‚æ•°-è§†é¢‘ä¸»é¢˜"
    },
    {
      "parameters": {
        "operation": "completion",
        "respondWith": "showText",
        "responseText": "=<pre>\n\n{{ $json['è§†é¢‘ç½‘å€'] }}\n\n</pre>",
        "limitWaitTime": true,
        "resumeUnit": "minutes"
      },
      "type": "n8n-nodes-base.form",
      "typeVersion": 1,
      "position": [
        0,
        0
      ],
      "id": "fd89a08d-fb77-41ca-94c3-dd5fc7a45fd2",
      "name": "è·³è½¬è§†é¢‘",
      "webhookId": "2c927904-2ec7-4f5c-9080-7c5cd2be2824"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "f13ed052-d4e4-4af8-a651-3d76fb737026",
              "name": "è§†é¢‘ç½‘å€",
              "value": "={{$node[\"ä¸Šä¼ æ–‡ä»¶\"].json[\"mediaLink\"]\n  .replace(\n    /https:\\/\\/storage\\.googleapis\\.com\\/download\\/storage\\/v1\\/b\\/([^\\/]+)\\/o\\/([^?]+)\\?generation=[^&]+&alt=media/,\n    \"https://storage.googleapis.com/$1/$2\"\n  )\n}}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -432,
        80
      ],
      "id": "a15670e2-7136-4ad8-a7fc-9b92f100b0e7",
      "name": "è®¾ç½®å‚æ•°-æœ€ç»ˆè§†é¢‘ç½‘å€"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "numberInputs": 3,
        "options": {
          "includeUnpaired": true
        }
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.1,
      "position": [
        -3744,
        544
      ],
      "id": "574e4b1d-e790-43f2-9106-5b119012eff6",
      "name": "è·¯ç”±-è¡¨å•"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/upload/v1beta/files",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json.gemini }}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-Goog-Upload-Protocol",
              "value": "resumable"
            },
            {
              "name": "X-Goog-Upload-Command",
              "value": "start"
            },
            {
              "name": "X-Goog-Upload-Header-Content-Length",
              "value": "={{ $json.fileSize }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"file\": {\n      \"display_name\": \"{{ $json.fileName }}\"\n    }\n  }",
        "options": {
          "response": {
            "response": {
              "fullResponse": true
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -3952,
        368
      ],
      "id": "152a37dd-540a-468b-95ef-4147ac8c1c21",
      "name": "è§†é¢‘é¢„å¤„ç†"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "numberInputs": 3,
        "options": {
          "includeUnpaired": true
        }
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.1,
      "position": [
        -4624,
        368
      ],
      "id": "b199d1e5-1840-44af-a416-a2be4e501beb",
      "name": "è·¯ç”±-è‡ªåŠ¨åŒ–"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://openapi.liblibai.cloud{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['Liblib ç”Ÿå›¾'] }}?AccessKey={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['Liblib AccessKey'] }}&Signature={{ $json.signature }}&Timestamp={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json.Timestamp }}&SignatureNonce={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json.SignatureNonce }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"templateUuid\": \"e10adc3949ba59abbe56e057f20f883e\",\n    \"generateParams\": {\n        \"checkPointId\": \"{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['ä¸»æ¨¡å‹ç¼–å·'] }}\",\n        \"prompt\": {{ JSON.stringify($('éå†').item.json.english_prompt) }},\n        \"negativePrompt\": \"ng_deepnegative_v1_75t,(badhandv4:1.2),EasyNegative,(worst quality:2),\",\n        \"sampler\": 1,\n        \"steps\": 28,\n        \"cfgScale\": 3.5,\n        \"width\": 1024,\n        \"height\": 576,\n        \"imgCount\": 1,\n        \"randnSource\": 0,\n        \"seed\": -1,\n        \"restoreFaces\": 0,\n        \"additionalNetwork\": [\n            {\n                \"modelId\": \"{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['Lora ç¼–å·'] }}\",\n                \"weight\": 0.8\n            }\n        ],\n        \"hiResFixInfo\": {\n            \"hiresSteps\": 30,\n            \"hiresDenoisingStrength\": 0.7,\n            \"upscaler\": 11,\n            \"resizedWidth\": 2048,\n            \"resizedHeight\": 1152\n        }\n    }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1312,
        416
      ],
      "id": "30fa1e7b-1cf2-4a09-a5ce-c2dcc1af561f",
      "name": "Liblib ç”Ÿå›¾"
    },
    {
      "parameters": {
        "amount": 1,
        "unit": "minutes"
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -1104,
        416
      ],
      "id": "d90b636c-64a7-4de3-b0bf-4bba595895bd",
      "name": "ç­‰å¾…",
      "webhookId": "6fb85bed-6770-4d5d-a6c8-88594db0b732"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "741fc5ba-a75a-4105-8900-5dfc807ff68d",
              "name": "raw",
              "value": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['Liblib ç”Ÿå›¾'] }}&{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json.Timestamp }}&{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json.SignatureNonce }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1984,
        416
      ],
      "id": "ced9f0c9-6f31-4786-a5cf-67ce642d7511",
      "name": "Liblibæ‹¼æ¥-ç”Ÿå›¾"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "741fc5ba-a75a-4105-8900-5dfc807ff68d",
              "name": "raw",
              "value": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['Liblib ç»“æœ'] }}&{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json.Timestamp }}&{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json.SignatureNonce }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -880,
        352
      ],
      "id": "bf47b695-85b4-4377-8be6-679814ae1cd3",
      "name": "Liblibæ‹¼æ¥-ç»“æœ"
    },
    {
      "parameters": {
        "action": "hmac",
        "type": "=SHA1",
        "value": "={{ $json.raw }}",
        "secret": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['Liblib SecretKey'] }}",
        "encoding": "base64"
      },
      "type": "n8n-nodes-base.crypto",
      "typeVersion": 1,
      "position": [
        -656,
        352
      ],
      "id": "cb1ac446-998e-436d-8024-36467df15b76",
      "name": "ç­¾å-ç»“æœ"
    },
    {
      "parameters": {
        "action": "hmac",
        "type": "=SHA1",
        "value": "={{ $json.raw }}",
        "secret": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['Liblib SecretKey'] }}",
        "encoding": "base64"
      },
      "type": "n8n-nodes-base.crypto",
      "typeVersion": 1,
      "position": [
        -1760,
        416
      ],
      "id": "343f8b7b-6dfc-4a7f-a503-35a516937276",
      "name": "ç­¾å-ç”Ÿå›¾"
    },
    {
      "parameters": {
        "jsCode": "// è·å–CryptoJSèŠ‚ç‚¹è¾“å‡ºçš„ç­¾å\nconst base64Signature = $input.first().json.data;\n\n// è½¬æ¢ä¸ºURL-safe Base64æ ¼å¼ï¼ˆä¸è¡¥å…¨ä½æ•°ï¼‰\nconst urlSafeSignature = base64Signature\n    .replace(/\\+/g, '-')    // å°† + æ›¿æ¢ä¸º -\n    .replace(/\\//g, '_')    // å°† / æ›¿æ¢ä¸º _\n    .replace(/=+$/, '');    // å»æ‰æœ«å°¾çš„ = å¡«å……å­—ç¬¦\n\nreturn {\n    json: {\n        ...($input.first().json),  // ä¿ç•™åŸæœ‰æ•°æ®\n        signature: urlSafeSignature  // æ·»åŠ æœ€ç»ˆç­¾å\n    }\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1536,
        416
      ],
      "id": "b881eddc-fb89-4d2f-97e6-4c1b0bf5c9bc",
      "name": "URL å®‰å…¨-ç”Ÿå›¾"
    },
    {
      "parameters": {
        "jsCode": "// è·å–CryptoJSèŠ‚ç‚¹è¾“å‡ºçš„ç­¾å\nconst base64Signature = $input.first().json.data;\n\n// è½¬æ¢ä¸ºURL-safe Base64æ ¼å¼ï¼ˆä¸è¡¥å…¨ä½æ•°ï¼‰\nconst urlSafeSignature = base64Signature\n    .replace(/\\+/g, '-')    // å°† + æ›¿æ¢ä¸º -\n    .replace(/\\//g, '_')    // å°† / æ›¿æ¢ä¸º _\n    .replace(/=+$/, '');    // å»æ‰æœ«å°¾çš„ = å¡«å……å­—ç¬¦\n\nreturn {\n    json: {\n        ...($input.first().json),  // ä¿ç•™åŸæœ‰æ•°æ®\n        signature: urlSafeSignature  // æ·»åŠ æœ€ç»ˆç­¾å\n    }\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -432,
        352
      ],
      "id": "c9ea9aba-5344-4e3b-9b5f-f5fea4b5589c",
      "name": "URL å®‰å…¨-ç»“æœ"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://openapi.liblibai.cloud{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['Liblib ç»“æœ'] }}?AccessKey={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['Liblib AccessKey'] }}&Signature={{ $json.signature }}&Timestamp={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json.Timestamp }}&SignatureNonce={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json.SignatureNonce }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "generateUuid",
              "value": "={{ $('Liblib ç”Ÿå›¾').item.json.data.generateUuid }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -224,
        336
      ],
      "id": "c5910464-508c-4fb7-9327-636ddcb09b62",
      "name": "Liblib ç»“æœ"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "29897656-ff7e-4b3b-9da1-25c4667d28d8",
              "leftValue": "={{ $('Liblib ç»“æœ').item.json.data.images[0].imageUrl }}",
              "rightValue": "https",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        224,
        416
      ],
      "id": "eab664a6-37c8-4733-aabf-3ba604e19da4",
      "name": "åˆ¤æ–­-Liblib"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "29897656-ff7e-4b3b-9da1-25c4667d28d8",
              "leftValue": "={{ $json.msg }}",
              "rightValue": "æ•æ„Ÿ",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "ca38bf69-d531-4cce-a9f3-88bb4e83be16",
              "leftValue": "={{ $json.msg }}",
              "rightValue": "æ— æ•ˆ",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        0,
        352
      ],
      "id": "b5824645-4bd0-4d30-b9c5-59b2f7aacb01",
      "name": "åˆ¤æ–­-Liblibæ•æ„Ÿ"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "444be79f-dde9-43d4-a92d-8cf9a6c60012",
              "name": "åœºæ™¯æ•°é‡",
              "value": "4",
              "type": "string"
            },
            {
              "id": "10cef148-320e-4e90-ac6d-0be1bfdfe27a",
              "name": "æç¤ºè¯ç¤ºä¾‹",
              "value": "=Film Photography,A group of African elephants drinking at a muddy watering hole in the heat of midday,while a herd of Cape buffalo waits nearby,tense yet respectful. The sun beats down harshly,casting strong shadows across cracked earth and drying trees. Some elephants spray water over their backs. Realistic texture,wildlife documentary style,high dynamic range,sharp focus on animal behavior and interaction.,",
              "type": "string"
            },
            {
              "id": "7519c5f4-4038-47ff-8efd-f3469b509d4c",
              "name": "å‚è€ƒè§†é¢‘",
              "value": "https://pub-b65afb21c951453a872a026d19411abe.r2.dev/dongwushijie.mp4",
              "type": "string"
            },
            {
              "id": "3501593a-511c-4064-a411-dcc37830457f",
              "name": "ä¸»é¢˜æ±‡æ€»",
              "value": "=ä»¿ç…§ bbc éæ´²åŠ¨ç‰©çºªå½•ç‰‡ç”Ÿæˆä¸€ç»„ä»‹ç»éæ´²å¤§è‰åŸä¸Šçš„ç‹®å­çš„åœºæ™¯ï¼Œç”»é¢çºªå®é£æ ¼ï¼Œå±•ç¤ºåŸå§‹çœŸå®çš„ç”»é¢é£æ ¼ä»¥åŠåŠ¨ç‰©ä¹‹ç‹ç‹®å­çš„åŸå§‹é£è²Œã€‚",
              "type": "string"
            },
            {
              "id": "35873205-92eb-4e35-83a9-04b85289061d",
              "name": "æµ·è¾¹",
              "value": "=1.  **Maldives** - é©¬å°”ä»£å¤«\n2.  **Bora Bora, French Polynesia** - æ³•å±æ³¢åˆ©å°¼è¥¿äºšï¼Œæ³¢æ‹‰æ³¢æ‹‰å²›\n3.  **Santorini, Greece** - å¸Œè…Šï¼Œåœ£æ‰˜é‡Œå°¼å²›\n4.  **Maui, Hawaii, USA** - ç¾å›½å¤å¨å¤·å·ï¼Œæ¯›ä¼Šå²›\n5.  **Phuket, Thailand** - æ³°å›½ï¼Œæ™®å‰å²›\n6.  **Bali, Indonesia** - å°åº¦å°¼è¥¿äºšï¼Œå·´å˜å²›\n7.  **Amalfi Coast, Italy** - æ„å¤§åˆ©ï¼Œé˜¿é©¬å°”è²æµ·å²¸\n8.  **Cancun, Mexico** - å¢¨è¥¿å“¥ï¼Œåæ˜†\n9.  **Seychelles** - å¡èˆŒå°”\n10. **Fiji** - æ–æµ\n11. **Gold Coast, Australia** - æ¾³å¤§åˆ©äºšï¼Œé»„é‡‘æµ·å²¸\n12. **Ibiza, Spain** - è¥¿ç­ç‰™ï¼Œä¼Šç»´è¨å²›\n13. **Mykonos, Greece** - å¸Œè…Šï¼Œç±³ç§‘è¯ºæ–¯å²›\n14. **Crete, Greece** - å¸Œè…Šï¼Œå…‹é‡Œç‰¹å²›\n15. **Copacabana, Rio de Janeiro, Brazil** - å·´è¥¿é‡Œçº¦çƒ­å†…å¢ï¼Œç§‘å¸•å¡å·´çº³æµ·æ»©\n16. **Waikiki Beach, Honolulu, Hawaii, USA** - ç¾å›½å¤å¨å¤·å·æª€é¦™å±±ï¼Œå¨åŸºåŸºæµ·æ»©\n17. **Nice, French Riviera, France** - æ³•å›½ï¼Œæ³•å±é‡Œç»´åŸƒæ‹‰ï¼Œå°¼æ–¯\n18. **St. Barts (Saint BarthÃ©lemy)** - åœ£å·´æ³°å‹’ç±³å²›ï¼ˆç®€ç§°åœ£å·´ç‰¹ï¼‰\n19. **Turks and Caicos Islands** - ç‰¹å…‹æ–¯å’Œå‡¯ç§‘æ–¯ç¾¤å²›\n20. **Barbados** - å·´å·´å¤šæ–¯\n21. **The Bahamas** - å·´å“ˆé©¬\n22. **Palawan, Philippines** - è²å¾‹å®¾ï¼Œå·´æ‹‰æœ›å²›\n23. **Kauai, Hawaii, USA** - ç¾å›½å¤å¨å¤·å·ï¼Œå¯çˆ±å²›\n24. **Capri, Italy** - æ„å¤§åˆ©ï¼Œå¡æ™®é‡Œå²›\n25. **Ko Phi Phi, Thailand** - æ³°å›½ï¼Œçš®çš®å²›\n26. **Zanzibar, Tanzania** - å¦æ¡‘å°¼äºšï¼Œæ¡‘ç»™å·´å°”\n27. **Mauritius** - æ¯›é‡Œæ±‚æ–¯\n28. **Langkawi, Malaysia** - é©¬æ¥è¥¿äºšï¼Œå…°å¡å¨\n29. **Galapagos Islands, Ecuador** - å„ç“œå¤šå°”ï¼ŒåŠ æ‹‰å¸•æˆˆæ–¯ç¾¤å²›\n30. **Fernando de Noronha, Brazil** - å·´è¥¿ï¼Œè´¹å°”å—å¤šÂ·è¿ªè¯ºç½—å°¼äºšç¾¤å²›",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -5440,
        448
      ],
      "id": "6a0c576a-778b-45af-9cf8-6fb317edd639",
      "name": "ä¸»é¢˜"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.5-flash-preview-05-20",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -5264,
        528
      ],
      "id": "c3083d13-efeb-4a8d-950d-751021d5c9e9",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "3Mxs5FRI0mH2OJBL",
          "name": "Google Gemini(PaLM) Api account 2"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['NCA url'] }}/v1/ffmpeg/compose",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "x-api-key",
              "value": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['NCA api key'] }}"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"id\": \"add-logo-and-keep-audio\",\n  \"inputs\": [\n    {\n      \"file_url\": \"{{ $json.response[0].file_url }}\"\n    },\n    {\n      \"file_url\": \"{{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['Logo ç½‘å€'] }}\"\n    }\n  ],\n  \"filters\": [\n    {\n      \"filter\": \"[1:v]scale=w=120:h=100:force_original_aspect_ratio=decrease[logo];[0:v][logo]overlay=W-w-20:20[outv]\"\n    }\n  ],\n  \"outputs\": [\n    {\n      \"options\": [\n        {\n          \"option\": \"-map\",\n          \"argument\": \"[outv]\"\n        },\n        {\n          \"option\": \"-map\",\n          \"argument\": \"0:a?\"\n        },\n        {\n          \"option\": \"-c:v\",\n          \"argument\": \"libx264\"\n        },\n        {\n          \"option\": \"-crf\",\n          \"argument\": \"23\"\n        },\n        {\n          \"option\": \"-preset\",\n          \"argument\": \"medium\"\n        },\n        {\n          \"option\": \"-c:a\",\n          \"argument\": \"aac\"\n        },\n        {\n          \"option\": \"-shortest\"\n        }\n      ]\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1104,
        80
      ],
      "id": "529e49ae-8fe9-405e-bc2b-3a9d1d2c59dc",
      "name": "æ°´å°åˆæˆ"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "21b7aa49-2c83-802c-b434-fc7868a02b32",
          "mode": "list",
          "cachedResultName": "33. ä¸å‰ªè¾‘ä¸æ‹æ‘„ï¼è¿™ä¸ª n8n è‡ªåŠ¨åŒ–å·¥ä½œæµæ‰¹é‡ç”Ÿæˆä¸‡ç§é£æ ¼æŠ–éŸ³ TikTok çˆ†æ¬¾çŸ­è§†é¢‘",
          "cachedResultUrl": "https://www.notion.so/21b7aa492c83802cb434fc7868a02b32"
        },
        "title": "={{ $workflow.id }}-{{ $execution.id }}",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "è§†é¢‘é“¾æ¥|url",
              "ignoreIfEmpty": true,
              "urlValue": "={{ $('è®¾ç½®å‚æ•°-æœ€ç»ˆè§†é¢‘ç½‘å€').item.json['è§†é¢‘ç½‘å€'] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        224,
        80
      ],
      "id": "079a4fd9-5706-4e14-8531-8ba9dea04655",
      "name": "ä¿å­˜è§†é¢‘"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "0859e5a4-b59b-442e-9ae0-c78cff421186",
                    "leftValue": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['åˆ†æ”¯'] }}",
                    "rightValue": "è¡¨å•",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "è¡¨å•"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('è®¾ç½®å‚æ•°-ç»¼åˆ').item.json['åˆ†æ”¯'] }}",
                    "rightValue": "è‡ªåŠ¨åŒ–",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    },
                    "id": "43aba877-703b-4116-a7cf-530c695d1786"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "è‡ªåŠ¨åŒ–"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -224,
        80
      ],
      "id": "2d39f07c-706b-467e-87b5-484e8fae621a",
      "name": "åˆ†æ”¯åˆ¤æ–­"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "updatedAt": "2025-08-09T04:30:49.222Z",
      "createdAt": "2025-08-09T04:30:49.222Z",
      "role": "workflow:owner",
      "workflowId": "HanNl2bP5zE6UScp",
      "projectId": "ougNWjAhJ4ikJ0c3"
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-08-09T04:30:56.000Z",
  "versionId": "bef48f41-d055-42cd-b601-2e538efc1511"
}